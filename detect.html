<!DOCTYPE html>
<head>
<meta charset=utf-8>
<title>Detecting HTML 5 Features - Dive Into HTML 5</title>
<!--[if IE]><script src=j/ie.js></script><![endif]-->
<link rel=stylesheet href=screen.css>
<style>
body{counter-reset:h1 2}
</style>
<meta name=viewport content="initial-scale=1.0">
</head>
<div id=body>
<p>You are here: <a href=index.html>Home</a> <span class=u>&#8227;</span> <!--<a href=table-of-contents.html#canvas>-->Dive Into <abbr>HTML</abbr> 5<!--</a>--> <span class=u>&#8227;</span>
<h1>Detecting <abbr>HTML</abbr> 5 Features</h1>
<p id=toc>&nbsp;
<p class=a>&#x2042;
<h2 id=divingin>Diving In</h2>

<p class=f><img src=i/aoc-y.png alt=Y width=106 height=105>ou may well ask: &#8220;How can I start using <abbr>HTML</abbr> 5 if older browsers don&#8217;t support it?&#8221; But the question itself is misleading. <abbr>HTML</abbr> 5 is not one big thing; it is a collection of individual features. So you can&#8217;t detect &#8220;<abbr>HTML</abbr> 5 support,&#8221; because that doesn&#8217;t make any sense. But you <em>can</em> detect support for individual features, like canvas, video, or geolocation.

<p class=a>&#x2042;

<h2 id=techniques>Detection Techniques</h2>

<p>When your browser renders a web page, it constructs a Document Object Model (<abbr>DOM</abbr>), a collection of objects that represent the <abbr>HTML</abbr> elements on the page. Every element&nbsp;&mdash;&nbsp;every <code>&lt;p></code>, every <code>&lt;div></code>, every <code>&lt;span></code>&nbsp;&mdash;&nbsp;is represented in the <abbr>DOM</abbr> by a different object. (There are also global objects, like <code>window</code> and <code>document</code>, that aren&#8217;t tied to specific elements.)

<p class=ss><img src=i/openclipart.org_johnny_automatic_peeking_out_the_window.png width=257 height=436 alt="girl peeking out the window">

<p>All <abbr>DOM</abbr> objects share a set of common properties, but some objects have more than others. In browsers that support <abbr>HTML</abbr> 5 features, certain objects will have unique properties. A quick peek at the <abbr>DOM</abbr> will tell you which features are supported.

<p>There are three basic techniques for detecting whether a browser supports a particular feature. From simplest to most complex:

<ol>
<li>
<p>Check if a property exists on a global object (such as <code>window</code> or <code>navigator</code>).
<p>Example: <a href=#geolocation>testing for geolocation support</a>
<li>
<p>Create an element, then check if a certain property exists on that element.
<p>Example: <a href=#canvas>testing for canvas support</a>
<li>
<p>Create an element, set a property to a certain value, then check if the property retained its value.
<p>Example: <a href=#input-types>testing for <code>&lt;input></code> types</a>
</ol>

<p class=a>&#x2042;

<h2 id=modernizr>Modernizr, the HTML 5 Detection Library</h2>

<p><a href=http://modernizr.com/>Modernizer</a> is an open source (<abbr>MIT</abbr>-licensed) JavaScript library that detects support for several HTML 5 features. To use it, include the following <code>&lt;script></code> element within the <code>&lt;head></code> element at the top of your page.

<pre style="float:left"><code>&lt;!DOCTYPE html>
&lt;html>
&lt;head>
  &lt;meta charset="utf-8">
  &lt;title>Dive Into HTML 5&lt;/title>
  <mark>&lt;script src="modernizr-1.0.min.js"></script></mark>
&lt;/head>
&lt;body>
  ...
&lt;/body>
&lt;/html>
</code></pre>
<p class="legend right" style="margin-top:7.25em"><span class=arrow>&nbsp;&#x219c;</span> It goes to your &lt;head>

<p class=clear>Modernizr runs automatically. There is no <code>modernizr_init()</code> function to call. When it runs, it creates an global object called <code>Modernizr</code>, which contains a set of Boolean properties for each feature it can detect. For example, if your browser supports the <a href=canvas.html>canvas <abbr>API</abbr></a>, the <code>Modernizr.canvas</code> property will be <code>true</code>. If your browser does not support the canvas <abbr>API</abbr>, the <code>Modernizr.canvas</code> property will be <code>false</code>.

<pre><code>if (Modernizr.canvas) {
  // let's draw some shapes!
} else {
  // no native canvas support available :(
}</code></pre>

<p class=a>&#x2042;

<!--
<h2 id=elements>New Semantic Elements</h2>

<p>FIXME

<p class=a>&#x2042;
-->

<h2 id=canvas>Canvas</h2>

<p><abbr>HTML</abbr> 5 defines <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html>the &lt;canvas> element</a> as &#8220;a resolution-dependent bitmap canvas which can be used for rendering graphs, game graphics, or other visual images on the fly.&#8221; A <dfn>canvas</dfn> is a rectangle in your page where you can use JavaScript to draw anything you want. <abbr>HTML</abbr> 5 defines a set of functions (&#8220;the canvas <abbr>API</abbr>&#8221;) for drawing shapes, defining paths, creating gradients, and applying transformations.

<p>Checking for the canvas <abbr>API</abbr> uses <a href=#techniques>detection technique #2</a>. If your browser supports the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates to represent a <code>&lt;canvas></code> element will have a <a href=canvas.html#shapes><code>getContext()</code> method</a>. If your browser doesn&#8217;t support the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates for a <code>&lt;canvas></code> element will only have the set of common properties, but not anything canvas-specific.

<pre><code>function supports_canvas() {
  return !!document.createElement('canvas').getContext;
}
</code></pre>

<p class=ss><img src=i/openclipart.org_johnny_automatic_canoe_traveling.png width=159 height=140 alt="two men in a canoe">

<p>This function starts by creating a dummy <code>&lt;canvas></code> element. But the element is never attached to your page, so no one will ever see it. It&#8217;s just floating in memory, going nowhere and doing nothing, like a canoe on a lazy river.

<pre><code>return !!document.<mark>createElement('canvas')</mark>.getContext;</code></pre>

<p>As soon as you create the dummy <code>&lt;canvas></code> element, you test for the presence of a <code>getContext()</code> method. This method will only exist if your browser supports the canvas <abbr>API</abbr>.

<pre><code>return !!document.createElement('canvas').<mark>getContext</mark>;</code></pre>

<p>Finally, you use the double-negative trick to force the result to a Boolean value (<code>true</code> or <code>false</code>).

<pre><code>return <mark>!!</mark>document.createElement('canvas').getContext;</code></pre>

<p>This function will detect support for most of the canvas <abbr>API</abbr>, including <a href=canvas.html#shapes>shapes</a>, <a href=canvas.html#paths>paths</a>, <a href=canvas.html#gradients>gradients <i class=baa>&amp;</i> patterns</a>. It will not detect the third-party <a href=canvas.html#ie><code>explorercanvas</code> library</a> that implements the canvas <abbr>API</abbr> in Microsoft Internet Explorer.

<p>Instead of writing this function yourself, you can use <a href=#modernizr>Modernizr</a> to detect support for the canvas <abbr>API</abbr>.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for canvas support
<pre><code>if (<mark>Modernizr.canvas</mark>) {
  // let's draw some shapes!
} else {
  // no native canvas support available :(
}</code></pre>

<p>There is a separate test for the canvas text <abbr>API</abbr>, which I will demonstrate next.

<p class=a>&#x2042;

<h2 id=canvas-text>Canvas Text</h2>

<p class=ss><img src=i/openclipart.org_johnny_automatic_baseball_at_bat.png width=414 height=254 alt="baseball player at bat">

<p>Even if your browser supports the <a href=#canvas>canvas <abbr>API</abbr></a>, it might not support the canvas text <abbr>API</abbr>. The canvas <abbr>API</abbr> grew over time, and the text functions were added late in the game. Some browsers shipped with canvas support before the text <abbr>API</abbr> was complete.

<p>Checking for the canvas text <abbr>API</abbr> uses <a href=#techniques>detection technique #2</a>. If your browser supports the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates to represent a <code>&lt;canvas></code> element will have the <a href=canvas.html#shapes><code>getContext()</code> method</a>. If your browser doesn&#8217;t support the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates for a <code>&lt;canvas></code> element will only have the set of common properties, but not anything canvas-specific.

<pre><code>function supports_canvas_text() {
  if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (typeof context.fillText == 'function');
}</code></pre>

<p>The function starts by <a href=#canvas>checking for canvas support</a>, using the <code>supports_canvas()</code> function you just saw in the previous section. If your browser doesn&#8217;t support the canvas <abbr>API</abbr>, it certainly won&#8217;t support the canvas text <abbr>API</abbr>!

<pre><code>if (<mark>!supports_canvas()</mark>) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (typeof context.fillText == 'function');</code></pre>

<p>Next, you create a dummy <code>&lt;canvas></code> element and get its drawing context. This is guaranteed to work, because the <code>supports_canvas()</code> function already checked that the <code>getContext()</code> method exists on all canvas objects.

<pre><code>if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = <mark>dummy_canvas.getContext('2d')</mark>;
  return (typeof context.fillText == 'function');</code></pre>

<p>Finally, you check whether the drawing context has a <code>fillText()</code> function. If it does, the canvas text <abbr>API</abbr> is available. Hooray!

<pre><code>if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (<mark>typeof context.fillText == 'function'</mark>);</code></pre>

<p>Instead of writing this function yourself, you can use <a href=#modernizr>Modernizr</a> to detect support for the canvas text <abbr>API</abbr>.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for canvas text support
<pre><code>if (<mark>Modernizr.canvastext</mark>) {
  // let's draw some text!
} else {
  // no native canvas text support available :(
}</code></pre>

<p class=a>&#x2042;

<h2 id=video>Video</h2>

<p><abbr>HTML</abbr> 5 defines a new element called <code>&lt;video></code> for embedding video in your web pages. Embedding video used to be impossible without third-party plugins such as Apple QuickTime&reg; or Adobe Flash&reg;.

<p style="float:left;margin:0 1.75em 1.75em 0"><img src=i/openclipart.org_johnny_automatic_at_the_theater.png alt="audience at the theater" width=224 height=334>

<p>The <code>&lt;video></code> element is designed to be usable without any detection script at all. You can specify multiple video files, and browsers that support <abbr>HTML</abbr> 5 video will choose one based on what types of video they support. (See &#8220;A gentle introduction to video encoding&#8221; <a href=http://diveintomark.org/archives/2008/12/18/give-part-1-container-formats>part 1: container formats</a> and <a href=http://diveintomark.org/archives/2008/12/19/give-part-2-lossy-video-codecs>part 2: lossy video codecs</a> to learn about the different types of videos.)

<p>Browsers that don&#8217;t support <abbr>HTML</abbr> 5 video will ignore the <code>&lt;video></code> element completely, but you can use this to your advantage and tell them to play video through a third-party plugin instead. Kroc Camen has designed a solution called <a href=http://camendesign.com/code/video_for_everybody>Video for Everybody!</a> which uses <abbr>HTML</abbr> 5 video where available, but falls back to Apple QuickTime&reg; or Adobe Flash&reg; in older browsers. This solution uses no JavaScript whatsoever, and it works in virtually every browser, including mobile browsers. I&#8217;ll explain more about this solution in the video chapter, whenever I get around to writing it.

<p>If you want to do more with video than plop it on your page and play it, you&#8217;ll need to use JavaScript. Checking for video support uses <a href=#techniques>detection technique #2</a>. If your browser supports <abbr>HTML</abbr> 5 video, the <abbr>DOM</abbr> object it creates to represent a <code>&lt;video></code> element will have a <code>canPlayType()</code> method. If your browser doesn&#8217;t support <abbr>HTML</abbr> 5 video, the <abbr>DOM</abbr> object it creates for a <code>&lt;video></code> element will only have the set of properties common to all elements.

<pre><code>function supports_video() {
  return !!document.createElement('video').canPlayType;
}</code></pre>

<p>Instead of writing this function yourself, you can use <a href=#modernizr>Modernizr</a> to detect support for <abbr>HTML</abbr> 5 video.

<p class="legend top" style="padding-left:6em"><span class=arrow>&#x21b6;</span> check for <abbr>HTML</abbr> 5 video support
<pre><code>if (<mark>Modernizr.video</mark>) {
  // let's play some video!
} else {
  // no native video support available :(
}</code></pre>

<p>There is a separate test for detecting which types of video your browser can play, which I will demonstrate next.

<p class=a>&#x2042;

<h2 id=video-codecs>Video Codecs</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=local-storage>Local Storage</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=offline>Offline Support</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=geolocation>Geolocation</h2>

<p>FIXME

<p>If your browser supports the geolocation <abbr>API</abbr>, the global <code>navigator</code> object will have a property called <code>geolocation</code>.

<blockquote>
<pre><code>function supports_geolocation() {
  return !!navigator.geolocation;
}</code></pre>
</blockquote>

<p class=a>&#x2042;

<h2 id=input-types>Input Types</h2>

<blockquote>
<pre><code>function supports_input_type_search() {
  var dummy_input = document.createElement('input');
  dummy_input.setAttribute('type', 'search');
  return !!(dummy_input.type !== 'text');
}
</code></pre>
</blockquote>

<p class=a>&#x2042;

<h2 id=input-placeholder>&lt;input placeholder></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-autofocus>&lt;input autofocus></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-required>&lt;input required></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-autocomplete>&lt;input autocomplete></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-pattern>&lt;input pattern></h2>

<p>FIXME

<p class=a>&#x2042;

<p class=c>Copyright MMIX O&#8217;Reilly Media &bull; written by <a href=about.html>Mark Pilgrim</a>

<form action=http://www.google.com/cse><div><input type=hidden name=cx value=014021643941856155761:6jgee_nxreo><input type=hidden name=ie value=UTF-8><input type=search name=q size=25>&nbsp;<input type=submit name=sa value=Search></div></form>
</div>
<script src=j/jquery.js></script>
<script src=j/dih5.js></script>

<!DOCTYPE html>
<head>
<meta charset=utf-8>
<title>Detecting HTML 5 Features - Dive Into HTML 5</title>
<!--[if IE]><script src=j/ie.js></script><![endif]-->
<link rel=stylesheet href=screen.css>
<style>
body{counter-reset:h1 12}
</style>
<meta name=viewport content="initial-scale=1.0">
</head>
<div id=body>
<p>You are here: <a href=index.html>Home</a> <span class=u>&#8227;</span> <!--<a href=table-of-contents.html#canvas>-->Dive Into <abbr>HTML</abbr> 5<!--</a>--> <span class=u>&#8227;</span>
<h1>Detecting <abbr>HTML</abbr> 5 Features</h1>
<p id=toc>&nbsp;
<p class=a>&#x2042;
<h2 id=divingin>Diving In</h2>

<p class=f><img src=i/aoc-y.png alt=Y width=106 height=105>ou may well ask: &#8220;How can I start using <abbr>HTML</abbr> 5 if older browsers don&#8217;t support it?&#8221; But the question itself is misleading. <abbr>HTML</abbr> 5 is not one big thing; it is a collection of individual features. So you can&#8217;t detect &#8220;<abbr>HTML</abbr> 5 support,&#8221; because that doesn&#8217;t make any sense. But you <em>can</em> detect support for individual features, like canvas, video, or geolocation.

<p class=a>&#x2042;

<h2 id=techniques>Detection Techniques</h2>

<p>When your browser renders a web page, it constructs a Document Object Model (<abbr>DOM</abbr>), a collection of objects that represent the <abbr>HTML</abbr> elements on the page. Every element&nbsp;&mdash;&nbsp;every <code>&lt;p></code>, every <code>&lt;div></code>, every <code>&lt;span></code>&nbsp;&mdash;&nbsp;is represented in the <abbr>DOM</abbr> by a different object. (There are also global objects, like <code>window</code> and <code>document</code>, that aren&#8217;t tied to specific elements.)

<p>All <abbr>DOM</abbr> objects share a set of common properties, but some objects have more than others. In browsers that support <abbr>HTML</abbr> 5 features, certain objects will have unique properties which you can detect with a few lines of JavaScript.

<p>There are three basic techniques for detecting whether a browser supports an <abbr>HTML</abbr> 5 feature. From simplest to most complex:

<ol>
<li>
<p>Check if a property exists on a global object (such as <code>window</code> or <code>navigator</code>).
<p>Example: <a href=#geolocation>testing for geolocation support</a>
<li>
<p>Create an element, then check if a certain property exists on that element.
<p>Example: <a href=#canvas>testing for canvas support</a>
<li>
<p>Create an element, set a property to a certain value, then check if the property retained its value.
<p>Example: <a href=#input-types>testing for <code>&lt;input></code> types</a>
</ol>

<p class=a>&#x2042;

<h2 id=elements>New Semantic Elements</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=canvas>Canvas</h2>

<p class=ss><img src=i/openclipart.org_johnny_automatic_canoe_traveling.png width=159 height=140 alt="two men in a canoe">
<p>Checking for the canvas <abbr>API</abbr> uses <a href=#techniques>detection technique #2</a>. If your browser supports the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates to represent a <code>&lt;canvas></code> element will have the <a href=canvas.html#shapes><code>getContext()</code> method</a>. If your browser doesn&#8217;t support the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates for a <code>&lt;canvas></code> element will only have the set of common properties, but not anything canvas-specific.

<pre><code>function supports_canvas() {
  return !!document.createElement('canvas').getContext;
}
</code></pre>

<p>This function starts by creating a dummy <code>&lt;canvas></code> element. But the element is never attached to your page, so no one will ever see it. It&#8217;s just floating in memory, going nowhere and doing nothing, like a canoe on a lazy river.

<pre><code>return !!document.<mark>createElement('canvas')</mark>.getContext;</code></pre>

<p>As soon as you create the dummy <code>&lt;canvas></code> element, you test for the presence of a <code>getContext()</code> method. This method will only exist if your browser supports the canvas <abbr>API</abbr>.

<pre><code>return !!document.createElement('canvas').<mark>getContext</mark>;</code></pre>

<p>Finally, you use the double-negative trick to force the result to a Boolean value (<code>true</code> or <code>false</code>).

<pre><code>return <mark>!!</mark>document.createElement('canvas').getContext;</code></pre>

<p>This function will detect support for the basic canvas <abbr>API</abbr>. That includes <a href=canvas.html#shapes>shapes</a>, <a href=canvas.html#paths>paths</a>, <a href=canvas.html#gradients>gradients <i class=baa>&amp;</i> patterns</a>. It will not detect the third-party <a href=canvas.html#ie><code>explorercanvas</code> library</a> that implements the canvas <abbr>API</abbr> in Microsoft Internet Explorer.

<p>There is a separate test for the canvas text <abbr>API</abbr>, which I will demonstrate next.

<p class=a>&#x2042;

<h2 id=canvas-text>Canvas Text</h2>

<p>Checking for the canvas text <abbr>API</abbr> uses <a href=#techniques>detection technique #2</a>. If your browser supports the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates to represent a <code>&lt;canvas></code> element will have the <a href=canvas.html#shapes><code>getContext()</code> method</a>. If your browser doesn&#8217;t support the canvas <abbr>API</abbr>, the <abbr>DOM</abbr> object it creates for a <code>&lt;canvas></code> element will only have the set of common properties, but not anything canvas-specific.

<p>Even if your browser supports the <a href=#canvas>basic canvas <abbr>API</abbr></a>, it might not support the canvas text <abbr>API</abbr>. The canvas <abbr>API</abbr> grew over time, and the text functions were added late in the game. Some browsers shipped with basic canvas support before the text <abbr>API</abbr> was finalized.

<pre><code>function supports_canvas_text() {
  if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (typeof context.fillText == 'function');
}</code></pre>

<p>The function starts by <a href=#canvas>checking for basic canvas support</a>, using the <code>supports_canvas()</code> function you just saw in the previous section. If your browser doesn&#8217;t support the basic canvas <abbr>API</abbr>, it certainly won&#8217;t support the canvas text <abbr>API</abbr>!

<pre><code>if (<mark>!supports_canvas()</mark>) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (typeof context.fillText == 'function');</code></pre>

<p>Next, you create a dummy <code>&lt;canvas></code> element and get its drawing context. This is guaranteed to work, because the <code>supports_canvas()</code> function already checked that the <code>getContext()</code> method exists on all canvas objects.

<pre><code>if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = <mark>dummy_canvas.getContext('2d')</mark>;
  return (typeof context.fillText == 'function');</code></pre>

<p>Finally, you check whether the drawing context has a <code>fillText()</code> function. If it does, the canvas text <abbr>API</abbr> is available. Hooray!

<pre><code>if (!supports_canvas()) { return false; }
  var dummy_canvas = document.createElement('canvas');
  var context = dummy_canvas.getContext('2d');
  return (<mark>typeof context.fillText == 'function'</mark>);</code></pre>

<p class=a>&#x2042;

<h2 id=video>Audio &amp; Video</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=video-codecs>Video Codecs</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=audio-codecs>Audio Codecs</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=local-storage>Local Storage</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=offline>Offline Support</h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=geolocation>Geolocation</h2>

<p>FIXME

<p>If your browser supports the geolocation <abbr>API</abbr>, the global <code>navigator</code> object will have a property called <code>geolocation</code>.

<blockquote>
<pre><code>function supports_geolocation() {
  return !!navigator.geolocation;
}</code></pre>
</blockquote>

<p class=a>&#x2042;

<h2 id=input-types>Input Types</h2>

<blockquote>
<pre><code>function supports_input_type_search() {
  var dummy_input = document.createElement('input');
  dummy_input.setAttribute('type', 'search');
  return !!(dummy_input.type !== 'text');
}
</code></pre>
</blockquote>

<p class=a>&#x2042;

<h2 id=input-placeholder>&lt;input placeholder></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-autofocus>&lt;input autofocus></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-required>&lt;input required></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-autocomplete>&lt;input autocomplete></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=input-pattern>&lt;input pattern></h2>

<p>FIXME

<p class=a>&#x2042;

<h2 id=modernizr>Modernizr, the HTML 5 Detection Library</h2>

<p>FIXME

<p class=a>&#x2042;

<p class=c>Copyright MMIX O&#8217;Reilly Media &bull; written by <a href=about.html>Mark Pilgrim</a>

<form action=http://www.google.com/cse><div><input type=hidden name=cx value=014021643941856155761:6jgee_nxreo><input type=hidden name=ie value=UTF-8><input type=search name=q size=25>&nbsp;<input type=submit name=sa value=Search></div></form>
</div>
<script src=j/jquery.js></script>
<script src=j/dih5.js></script>

<!DOCTYPE html>
<head>
<meta charset=utf-8>
<title>Let&#8217;s Call It a Draw(ing Surface) - Dive Into HTML 5</title>
<!--[if IE]><script src=j/html5.js></script><![endif]-->
<link rel=stylesheet href=screen.css>
<style>
body{counter-reset:h1 4}
canvas{border:1px dotted}
</style>
<meta name=viewport content='initial-scale=1.0'>
</head>
<p>You are here: <a href=index.html>Home</a> <span class=u>&#8227;</span> <!--<a href=table-of-contents.html#canvas>-->Dive Into HTML 5<!--</a>--> <span class=u>&#8227;</span>
<h1>Let&#8217;s Call It A Draw(ing Surface)</h1>
<p id=toc>&nbsp;
<p class=a>&#x2042;
<h2 id=divingin>Diving In</h2>
<p class=f><img src=i/H.png alt=H width=104 height=102>TML 5 defines <a href=http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html>the &lt;canvas&gt; element</a> as &#8220;a resolution-dependent bitmap canvas which can be used for rendering graphs, game graphics, or other visual images on the fly.&#8221; A <dfn>canvas</dfn> is a rectangle in your page where you can use JavaScript to draw anything you want.</p>

<p>So what is a canvas?</p>

<canvas width=300 height=225></canvas>
<p class=legend><span class=arrow>&#x219c;</span> A canvas

<p>The markup looks like this:

<pre class=nd><code class=pp>&lt;canvas width="300" height="225"&gt;</code></pre>

<p>(I also used CSS to add a dotted border around the canvas. The <code>&lt;canvas&gt;</code> element has no border by default.)

<p>You can have several <code>&lt;canvas&gt;</code> elements on the same page. Each canvas will show up in the <abbr>DOM</abbr>, and each canvas maintains its own state. If you give each canvas an <code>id</code> attribute, you can access them just like any other element.

<p>Let&#8217;s expand that markup to include an <code>id</code> attribute:

<pre class=nd><code class=pp>&lt;canvas id="a" width="300" height="225"&gt;</code></pre>

<p>Now you can easily find that <code>&lt;canvas&gt;</code> element in the <abbr>DOM</abbr>.

<pre class=nd><code class=pp>var a_canvas = document.getElementById("a");</code></pre>

<p class=a>&#x2042;

<h2 id=shapes>Simple Shapes</h2>

<p class=ss><img src=i/openclipart.org_media_files_johnny_automatic_4145.png width=449 height=433 alt='man drawing in front of a mirror'>

<p>Every canvas starts out blank. That&#8217;s boring! Let&#8217;s draw something.</p>

<canvas id=b width=300 height=225></canvas>
<p class=legend><span class=arrow>&#x21dc;</span> <a href="#" onclick="draw_b();return false">Click to draw on this canvas</a></p>

<p>The <code>onclick</code> handler called this function:

<pre class=nd><code class=pp>function draw_b() {
  var b_canvas = document.getElementById("b");
  var b_context = b_canvas.getContext("2d");
  b_context.fillRect(25,25,100,100);
}</code></pre>

<p>The first line of the function is nothing special; it just finds the <code>&lt;canvas&gt;</code> element in the <abbr>DOM</abbr>.

<p class="legend left">And then there&#8217;s this <span class=arrow>&#x21dd;</span>&nbsp;</p>
<pre class="nd np"><code class=pp>function draw_b() {
  var b_canvas = document.getElementById("b");
<mark>  var b_context = b_canvas.getContext("2d");</mark>
  b_context.fillRect(50, 25, 150, 100);
}</code></pre>

<p>Every canvas has a drawing <dfn>context</dfn>, which is where all the fun stuff happens. Once you&#8217;ve found a <code>&lt;canvas&gt;</code> element in the <abbr>DOM</abbr> (by using <code>document.getElementById()</code> or any other method you like), you call its <code>getContext()</code> method. You <strong>must</strong> pass the string <code>'2d'</code> to the <code>getContext()</code> method.

<div class=pf style="margin:3.112em">
<blockquote class=note>
<p><span>&#x261E;</span>Q: Is there a 3-D canvas?<br>
A: Not yet. Individual vendors have experimented with their own three-dimensional canvas APIs, but none of them have been standardized. The HTML 5 specification notes, &#8220;A future version of this specification will probably define a 3d context.&#8221;
</blockquote>
</div>

<p>You have a <code>&lt;canvas&gt;</code> element, and you have its drawing context. The drawing context is where all the drawing methods and properties are defined. There&#8217;s a whole group of methods devoted to drawing rectangles:

<ul>
<li>The <code>fillStyle</code> property can be a <abbr>CSS</abbr> color, a pattern, or a gradient. (More on patterns and gradients shortly.) The default <code>fillStyle</code> is solid black, but you can set it to whatever you like. Each canvas remembers its own properties as long as the page is open.
<li><code>fillRect(x, y, width, height)</code> draws a rectangle filled with the current fill style.
<li>The <code>strokeStyle</code> property is like <code>fillStyle</code>&nbsp;&mdash;&nbsp;it can be a CSS color, pattern, or gradient.
<li><code>strokeRect(x, y, width, height)</code> draws an rectangle with the current stroke style. <code>strokeRect</code> doesn&#8217;t fill in the middle; it just draws the edges.
<li><code>clearRect(x, y, width, height)</code> clears the pixels in the specified rectangle.
</ul>

<p>Getting back to that code sample in the previous example&hellip;
<p class="legend left">This draws the rectangle <span class=arrow>&#x21dd;</span>&nbsp;</p>
<pre class="nd np"><code class=pp>  var b_canvas = document.getElementById("b");
  var b_context = b_canvas.getContext("2d");
<mark>  b_context.fillRect(50, 25, 150, 100);</mark></code></pre>

<p class=clear>Calling the <code>fillRect()</code> method draws the rectangle and fills it with the current fill style, which is black until you change it. The rectangle is bounded by its upper-left corner (50,&nbsp;25), its width (150), and its height (100). To get a better picture of how that works, let&#8217;s look at the canvas coordinate system.

<p class=a>&#x2042;

<h2 id=coordinates>Canvas Coordinates</h2>

<p>The canvas is a two-dimensional grid. The coordinate (0, 0) is at the upper-left corner of the canvas. Along the X-axis, values increase towards the right edge of the canvas. Along the Y-axis, values increase towards the bottom edge of the canvas.

<p class='legend top' style="width:500px;text-align:center">canvas coordinates diagram<span class=arrow>&#x21b7;</span><br></p>
<canvas id=c width=500 height=375></canvas>

<p class=a>&#x2042;

<h2 id=paths>Paths</h2>

<p>That coordinate diagram was drawn with a <code>&lt;canvas&gt;</code> element. It comprises

<ul>
<li>a set of off-white vertical lines
<li>a set of off-white horizontal lines
<li>a black horizontal line
<li>the letter &#8220;x&#8221;
<li>another black horizontal line
<li>two small black diagonal lines that form an arrow
<li>a black vertical line
<li>the letter &#8220;y&#8221;
<li>another black vertical line
<li>two small black diagonal lines that form another arrow
<li>a dot&nbsp;&mdash;&nbsp;actually a very small rectangle&nbsp;&mdash;&nbsp;in the upper-left corner
<li>the text &#8220;(0, 0)&#8221;
<li>another dot in the lower-right corner
<li>the text &#8220;(500, 375)&#8221;
</ul>

<p>First, we need to define the <code>&lt;canvas&gt;</code> element itself. The <code>&lt;canvas&gt;</code> element defines the <code>width</code> and <code>height</code>, and the <code>id</code> so we can find it later.

<pre class=nd><code class=pp>&lt;canvas id="c" width="500" height="375"></code></pre>

<p>Then we need a script to find the <code>&lt;canvas&gt;</code> element in the DOM and get its drawing context.

<pre class=nd><code class=pp>var c_canvas = document.getElementById("c");
var c_context = c_canvas.getContext("2d");</code></pre>

<p>Let&#8217;s also get the canvas dimensions.

<pre class=nd><code class=pp>var c_width = c_canvas.width;
var c_height = c_canvas.height;</code></pre>

<p style="float:left;margin:1.75em 1.75em 1.75em 0"><img src=i/openclipart.org_media_files_johnny_automatic_7563.png alt="gerbil sitting on a chair with a quill and ink jar" width=167 height=347>

<p>Now we can start drawing lines. Imagine you&#8217;re drawing a picture in ink. You don&#8217;t want to just dive in and start drawing with ink, because you might make a mistake. First, you sketch lines and curves with a pencil. Once you&#8217;re happy with it, you trace over the whole thing in ink.

<p>Each canvas has a <dfn>path</dfn>. Defining the path is like drawing with a pencil. You can draw whatever you like, but it won&#8217;t be part of the finished product until you pick up the quill and trace over your path in ink.

<p>To draw straight lines in pencil:

<ol>
<li><code>moveTo(x, y)</code> moves the pencil to the starting point.
<li><code>lineTo(x, y)</code> draws a line to an ending point.
<li>Go to step 1.
</ol>

<p>The more you call <code>moveTo()</code> and <code>lineTo()</code>, the biggest the path gets. These are &#8220;pencil&#8221; methods&nbsp;&mdash;&nbsp;you can call them as often as you like, but you won&#8217;t see anything on the canvas until you call one of the &#8220;ink&#8221; methods.

<p>Let&#8217;s draw the off-white grid.

<pre class='nd ib'><code class=pp>for (var i = 0; i < c_width; i+=10) {
  c_context.moveTo(i, 0);
  c_context.lineTo(i, c_height);
}</code></pre>
<p class=legend><span class=arrow>&#x21dc;</span> This draws vertical lines</p>

<p style="clear:both">

<pre class='nd ib'><code class=pp>for (var j = 0; j < c_height; j+=10) {
  c_context.moveTo(0, j);
  c_context.lineTo(c_width, j);
}</code></pre>
<p class=legend><span class=arrow>&#x21dc;</span> This draws horizontal lines</p>

<p style="clear:both">Those were all &#8220;pencil&#8221; methods. Nothing has actually been drawn on the canvas yet. We need an &#8220;ink&#8221; method to make it permanent.

<pre class=nd><code class=pp>c_context.strokeStyle = "#eee";
<mark>c_context.stroke();</mark></code></pre>

<p><code>stroke()</code> is one of the &#8220;ink&#8221; methods. It takes the complex path you defined with all those <code>moveTo()</code> and <code>lineTo()</code> calls, and it actually draws it on the canvas. The <code>strokeStyle</code> controls the color of the lines, and this is the result:</p>

<canvas id=c2 width=500 height=375></canvas>

<p>&hellip;FIXME

<p class=a>&#x2042;

<h2 id=text>Text</h2>

<p class=a>&#x2042;

<h2 id=images>Images</h2>

<p class=a>&#x2042;

<h2 id=transforms>Transforms</h2>

<p class=a>&#x2042;

<h2 id=shadows>Shadows</h2>

<p class=a>&#x2042;

<h2 id=data>Canvas <span class=u>&#8227;</span> Save As&hellip;</h2>

<p class=a>&#x2042;

<h2 id=ie>What About IE?</h2>

<p class=a>&#x2042;

<p class=c>Copyright MMIX O&#8217;Reilly Media &bull; written by <a href=about.html>Mark Pilgrim</a>

<form action=http://www.google.com/cse><div><input type=hidden name=cx value=014021643941856155761:6jgee_nxreo><input type=hidden name=ie value=UTF-8><input name=q size=25>&nbsp;<input type=submit name=sa value=Search></div></form>

<script src=j/jquery.js></script>
<script src=j/prettify.js></script>
<script src=j/dih5.js></script>
<script>
function draw_b() {
  var b_canvas = document.getElementById("b");
  var b_context = b_canvas.getContext("2d");
  b_context.fillRect(50, 25, 150, 100);
}
function draw_grid(c_canvas) {
  var c_context = c_canvas.getContext("2d");
  var c_width = c_canvas.width;
  var c_height = c_canvas.height;

  /* background grid */
  for (var i = 0; i < c_width; i+=10) {
    c_context.moveTo(i, 0);
    c_context.lineTo(i, c_height);
  }
  for (var j = 0; j < c_height; j+=10) {
    c_context.moveTo(0, j);
    c_context.lineTo(c_width, j);
  }
  c_context.strokeStyle = "#eee";
  c_context.stroke();
}
function draw_c() {
  var c_canvas = document.getElementById("c");
  var c_context = c_canvas.getContext("2d");
  draw_grid(c_canvas);

  /* x-axis */
  c_context.beginPath();
  c_context.strokeStyle = "#000";
  c_context.moveTo(0, 40);
  c_context.lineTo(240, 40);
  c_context.moveTo(260, 40);
  c_context.lineTo(500, 40);
  c_context.moveTo(495, 35);
  c_context.lineTo(500, 40);
  c_context.lineTo(495, 45);
  /* y-axis */
  c_context.moveTo(60, 0);
  c_context.lineTo(60, 153);
  c_context.moveTo(60, 173);
  c_context.lineTo(60, 375);
  c_context.moveTo(65, 370);
  c_context.lineTo(60, 375);
  c_context.lineTo(55, 370);

  /* dots */
  c_context.fillRect(0, 0, 3, 3);
  c_context.fillRect(497, 372, 3, 3);

  /* draw it! */
  c_context.stroke();
    
  /* labels */
  c_context.font = "12px Heletica, Arial, sans-serif";
  c_context.strokeText("x", 248, 43);
  c_context.strokeText("y", 58, 165);
  c_context.fillText("( 0 , 0 )", 8, 13);
  c_context.fillText("( 500 , 375 )", 425, 372);
}
function draw_c2() {
  var c2_canvas = document.getElementById("c2");
  draw_grid(c2_canvas);
}
$(document).ready(function() {
    draw_c();
    draw_c2();
});
</script>
